<include file="public/layout" />
<include file="public/goodsStyle"/>
</head>
<body style="overflow: auto;">
<div id="append_parent"></div>
<div id="ajaxwaitid"></div>
<div class="page">
    <div class="fixed-bar">
        <div class="item-title">
            <div class="subject">
                <h3>商城设置</h3>
                <!-- <h5>网站全局内容基本选项设置</h5> -->
            </div>
            <ul class="tab-base nc-row">
                <li><a href="javascript:void(0);" data-index='1' class="tab current"><span>通用信息</span></a></li>
            </ul>
        </div>
    </div>
    <!--表单数据-->
    <form method="post" id="addEditGoodsForm">
        <input type="hidden" name="cat_id" value="{$cat_id}">
<!--通用信息-->
        <div class="ncap-form-default tab_div_1">
            <dl class="row">
                <dt class="tit">
                    <label for="record_no"><em>*</em> 车后养护名称</label>
                </dt>
                <dd class="opt">
                    <input type="text" value="{$goodsInfo.goods_name}" name="goods_name" class="input-txt request"/>
                    <span class="err" id="err_goods_name" style="color:#F00; display:none;">请输入车后养护名称</span>
                </dd>
            </dl>
            <dl class="row">
                <dt class="tit">
                  <em>*</em><label for="record_no">服务范围</label>
                </dt>
                <dd class="opt">
                  <div class="goods_check" checked=""><input type="checkbox" class="all"><span>全选</span></div>
                  <volist name="tags" id="vo">
                    <in name="vo.id" value="$gtags" >
                     <div class="goods_check"><input type="checkbox" name="tags[]" value="{$vo.id}" checked="true"><span>{$vo.name}</span></div>
                     </in>
                     <notin  name="vo.id" value="$gtags">
                      <div class="goods_check"><input type="checkbox" name="tags[]" value="{$vo.id}" ><span>{$vo.name}</span></div>
                    </notin>  
                  </volist>
                </dd>
            </dl> 
            <dl class="row">
                <dt class="tit">
                    <label for="store_name">产品简介</label>
                </dt>
                <dd class="opt">
                    <textarea rows="3" cols="80" name="goods_remark" class="input-txt">{$goodsInfo.goods_remark}</textarea>
                    <span id="err_goods_remark" class="err" style="color:#F00; display:none;"></span>                   
                </dd>
            </dl> 
            <dl class="row">
              <dt class="tit">
                <label for="t_mane"><em>*</em>是否成为会员产品</label>
              </dt>
              <dd class="opt">
                <div class="onoff">
                  <label for="goods_category1" class="cb-enable <if condition="$goodsInfo[is_vip] eq 1">selected</if>">是</label>
                  <label for="goods_category0" class="cb-disable <if condition="$goodsInfo[is_vip] eq 0">selected</if>">否</label>
                  <input id="goods_category1" name="is_vip" value="1" type="radio" <if condition="$goodsInfo[is_vip] eq 1"> checked="checked"</if>>
                  <input id="goods_category0" name="is_vip" value="0" type="radio" <if condition="$goodsInfo[is_vip] eq 0"> checked="checked"</if>>
                </div>
              </dd>        
          </dl>
             <dl class="row" style="display: none;">
                <dt class="tit">
                    <label for="record_no">会员类型</label>
                </dt>
                <dd class="opt" >
                  <div class="vip_check"><input type="checkbox" class="vip_all"><span>全部</span></div>
                  <volist name="userLevel" id="vo">
                    <in name="vo.level_id" value="$gLevels">
                        <div class="vip_check vip"><input type="checkbox"  name="levels[]" value="{$vo.level_id}"  checked="true"><span>{$vo.level_name}</span></div>
                    </in>
                    <notin name="vo.level_id" value="$gLevels">
                         <div class="vip_check vip"><input type="checkbox"  name="levels[]" value="{$vo.level_id}"><span>{$vo.level_name}</span></div>
                    </notin>  
                </volist>
                    <span class="err" id="err_cat_id" style="color:#F00; display:none;">会员范围必选</span>
                </dd>
            </dl>
			
            <dl class="row">
                <dt class="tit">
                    <label for="record_no"><em>*</em> 产品价格</label>
                </dt>
                <dd class="opt">
                    <input type="text" value="{$goodsInfo.shop_price}" name="shop_price" class="t_mane request" onKeyUp="this.value=this.value.replace(/[^\d.]/g,'')" onpaste="this.value=this.value.replace(/[^\d.]/g,'')" />
                    <span class="err" id="err_shop_price" style="color:#F00; display:none;">请输入产品价格</span>
                </dd>
            </dl>             
            
            <dl class="row">
                <dt class="tit">
                    <label for="record_no"><em>*</em> 库存数量</label>
                </dt>
                <dd class="opt">                
                    <if condition="$goodsInfo[goods_id] gt 0">
                        <input type="text" value="{$goodsInfo.store_count}" class="t_mane request" name="store_count" onKeyUp="this.value=this.value.replace(/[^\d.]/g,'')" onpaste="this.value=this.value.replace(/[^\d.]/g,'')" />
                    <else />
                        <input type="text" value="{$imshop_config[basic_default_storage]}" class="t_mane request" name="store_count" onKeyUp="this.value=this.value.replace(/[^\d.]/g,'')" onpaste="this.value=this.value.replace(/[^\d.]/g,'')" />                                         
                    </if>
                    <span class="err" id="err_store_count" style="color:#F00; display:none;">请输入库存数量</span>
                </dd>
            </dl>  
                  <dl class="row">
        <dt class="tit"><em>*</em> 列表缩略图</dt>
        <dd class="opt">
           <div class="tab-pane" id="tab_goods_images">
                            <table class="table table-bordered">
                                <tbody>
                                <tr>                                    
                                    <td>                                    
                                    <foreach name="goodsImages" item="vo" key="k" >
                                    <if condition="$goodsInfo['original_img'] neq $vo['image_url']">
                                       <div style="width:100px; text-align:center; margin: 5px;display:inline-block;" class="goods_xc">
                                            <input type="hidden" value="{$vo['image_url']}" name="goods_images[]">
                                            <a onClick="" href="{$vo['image_url']}" target="_blank"><img width="100" height="100" src="{$vo['image_url']}"></a>
                                            <br>
                                            <a href="javascript:void(0)" onClick="ClearPicArr2(this,'{$vo['image_url']}')">删除</a>
                                        </div>
                                         </if>
                                    </foreach>
                                        <div class="goods_xc" style="width:100px; text-align:center; margin: 5px; display:inline-block;">
                                            <input type="hidden" name="goods_images[]" value="" />
                                            <a href="javascript:void(0);" onClick="GetUploadify(10,'','goods','call_back2');"><img src="/public/images/add-button.jpg" width="100" height="100" /></a>
                                            <br/>
                                            <a href="javascript:void(0)">&nbsp;&nbsp;</a>
                                        </div>                                        
                                    </td>
                                </tr>                                              
                                </tbody>
                            </table>
                        </div>
          <div id="thumbnails" class="ncap-thumb-list">
            <h5><i class="fa fa-exclamation-circle"></i> 请上传图片格式文件。</h5>
            <ul>
            </ul>
          </div>
        </dd>
      </dl>                     
		<dl class="row">
        <dt class="tit"><em>*</em> 商品主图</dt>
        <dd class="opt">
          <div class="input-file-show" id="divComUploadContainer">
            <span class="show">
                <a class="nyroModal" rel="gal" href="{$goodsInfo.original_img}">
                    <i class="fa fa-picture-o" onMouseOver="layer.tips('<img src={$goodsInfo.original_img}>',this ,{tips: [1, '#fff']});" onMouseOut="layer.closeAll();"></i>
                </a>
            </span>             
            <span class="type-file-box">            
            <input type="text" id="imagetext" name="original_img" value="{$goodsInfo.original_img}" class="type-file-text">            
            <input type="button" class="type-file-button" onClick="GetUploadify(1,'imagetext','goods','')" value="上传图片"  hidefocus="true" nc_type="change_site_logo" title="点击前方预览图可查看大图，点击按钮选择文件并提交表单后上传生效"/>
            </span>
          </div>
          <div id="thumbnails" class="ncap-thumb-list">
            <h5><i class="fa fa-exclamation-circle"></i> 请上传图片格式文件。</h5>
            <ul>
            </ul>
          </div>
        </dd>
      </dl>   
 
                        <dl class="row">
              <dt class="tit">
                <label for="t_mane"><em>*</em>是否指定商家</label>
              </dt>
              <dd class="opt">
                <div class="onoff">
                  <label for="is_appoint1" class="cb-enable <if condition="$goodsInfo[is_appoint] eq 1">selected</if>">是</label>
                  <label for="is_appoint0" class="cb-disable <if condition="$goodsInfo[is_appoint] eq 0">selected</if>">否</label>
                  <input id="is_appoint1" name="is_appoint" value="1" type="radio" <if condition="$goodsInfo[is_appoint] eq 1"> checked="checked"</if>>
                  <input id="is_appoint0" name="is_appoint" value="0" type="radio" <if condition="$goodsInfo[is_appoint] eq 0"> checked="checked"</if>>
                </div>
              </dd>        
          </dl>
          <dl class="row" style="display: none;">
                <dt class="tit">
                    <label for="record_no"></label>
                </dt>
                <dd class="opt" >
                   <volist name="usedShop" id="vo">
                  <div class="shop_check"><input type="checkbox" class="shop_all" name="shops[]" value="{$vo['admin_id']}" <if condition="$vo['selected'] eq 1">checked="true"</if>><span>{$vo['shop_name']}</span></div>
                </volist>
                </dd>
            </dl>
                        <dl class="row">
              <dt class="tit">
                <label for="t_mane"><em>*</em>是否指定使用时间</label>
              </dt>
              <dd class="opt">
                <div class="onoff">
                  <label for="is_ctime1" class="cb-enable <if condition="$goodsInfo[is_ctime] eq 1">selected</if>">是</label>
                  <label for="is_ctime0" class="cb-disable <if condition="$goodsInfo[is_ctime] eq 0">selected</if>">否</label>
                  <input id="is_ctime1" name="is_ctime" value="1" type="radio" <if condition="$goodsInfo[is_ctime] eq 1"> checked="checked"</if>>
                  <input id="is_ctime0" name="is_ctime" value="0" type="radio" <if condition="$goodsInfo[is_ctime] eq 0"> checked="checked"</if>>
                </div>
              </dd>        
          </dl>
          <dl class="row" style="display: none;">
                <dt class="tit">
                    <label for="record_no"></label>
                </dt>
                <dd class="opt" >
                  开始日期：<input type="text" id="startTime" name="start_time" <if condition="$times['start_time'] neq 0">value="{$times['start_time']|date='Y-m-d',###}"</if>>
                  结束日期：<input type="text" id="overTime" name="end_time" <if condition="$times['end_time'] neq 0">value="{$times['end_time']|date='Y-m-d',###}"</if>>
                  <script type="text/javascript" src="__PUBLIC__/static/layui/layui.js"></script>
                </dd>
            </dl>
            <dl class="row">
                <dt class="tit">
                    <label for="record_no"><em>*</em> 商品详情描述</label>
                </dt>
                <dd class="opt">                    
                    <textarea class="span12 ckeditor" id="goods_content" name="goods_content" title="">{$goodsInfo.goods_content}</textarea>
                    <span class="err" id="err_goods_content" style="color:#F00; display:none;">请输入商品详情描述</span>                    
                </dd>
            </dl>                                                                                                                                           
        </div>
<!-- 商品模型-->
		<div class="ncap-form-default tab_div_3" style="display:none;">
            <dl class="row">

                        <div class="tab-pane" id="tab_goods_spec">
                            <table class="table table-bordered" id="goods_spec_table">                                
                                <tr>
                                    <td>商品模型:</td>
                                    <td>                                        
                                      <select name="goods_type" id="spec_type" class="form-control" style="width:250px;">
                                        <option value="0">选择商品模型</option>
                                        <foreach name="goodsType" item="vo" key="k" >
                                            <option value="{$vo.id}"<if condition="$goodsInfo[goods_type] eq $vo[id]"> selected="selected" </if> >{$vo.name}</option>
                                        </foreach>                                        
                                      </select>
                                    </td>
                                </tr>                            
                            </table>
                            <div class="row">
                            	<!-- ajax 返回规格-->
                            	<div id="ajax_spec_data" class="col-xs-8" ></div>
                            	<div id="" class="col-xs-4" >
                            	    <table class="table table-bordered" id="goods_attr_table">                                
		                                <tr>
		                                    <td><b>商品属性</b>：</td>
		                                </tr>                                
		                            </table>
                            	</div>
                            </div>
                        </div>
                
            </dl>             
        </div>   
<!-- 商品模型-->         
<!-- 商品物流-->
		<div class="ncap-form-default tab_div_4" style="display:none;">
            <dl class="row">
                        <div class="tab-pane" id="tab_goods_shipping">
                            <h4><b>物流配送：</b><input type="checkbox" onClick="choosebox(this)">全选</h4>
                            <table class="table table-bordered table-striped dataTable" id="goods_shipping_table">
                                <foreach name="plugin_shipping" item="shipping" key="kk">
                                    <tr>
                                        <td class="title left" style="padding-right:50px;">
                                            <b>{$shipping[name]}：</b>
                                            <label class="right"><input type="checkbox" value="1" cka="mod-{$kk}">全选</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <ul class="group-list">
                                                <foreach name="shipping_area" item="vv">
                                                    <if condition="$vv[shipping_code] eq $shipping[code]">
                                                        <li><label><input type="checkbox" name="shipping_area_ids[]" value="{$vv.shipping_area_id}" <if condition="in_array($vv['shipping_area_id'],$goods_shipping_area_ids)">checked='checked='</if> ck="mod-{$kk}">{$vv.shipping_area_name}</label></li>
                                                    </if>
                                                </foreach>
                                                <div class="clear-both"></div>
                                            </ul>
                                        </td>
                                    </tr>
                                </foreach>
                            </table>
                        </div>                
            </dl>             
        </div>   
<!-- 商品物流-->
		<div class="ncap-form-default">        
            <div class="bot">            
                <input type="hidden" name="goods_id" value="{$goodsInfo.goods_id}">
                <input type="hidden" name="__token__" value="{$Request.token}" />
                <a href="JavaScript:void(0);" class="ncap-btn-big ncap-btn-green" onClick="ajaxSubmitForm('addEditGoodsForm','{:U('Goods/addEditGoods?is_ajax=1')}');">确认提交</a>
            </div>
        </div> 
     </form>
    <!--表单数据-->
</div>
<div id="goTop"> <a href="JavaScript:void(0);" id="btntop"><i class="fa fa-angle-up"></i></a><a href="JavaScript:void(0);" id="btnbottom"><i class="fa fa-angle-down"></i></a></div>
<script type="text/javascript" src="__PUBLIC__/static/js/addEditGoods.js"></script>
<script>

/** 以下是编辑时默认选中某个商品分类*/
$(document).ready(function(){

	<if condition="$level_cat['2'] gt 0">
		 // 商品分类第二个下拉菜单
		 get_category('{$level_cat[1]}','cat_id_2','{$level_cat[2]}');	
	</if>
	<if condition="$level_cat['3'] gt 0">
		// 商品分类第二个下拉菜单
		 get_category('{$level_cat[2]}','cat_id_3','{$level_cat[3]}');	 
	</if>

    //  扩展分类
	<if condition="$level_cat2['2'] gt 0">
		 // 商品分类第二个下拉菜单
		 get_category('{$level_cat2[1]}','extend_cat_id_2','{$level_cat2[2]}');	
	</if>
	<if condition="$level_cat2['3'] gt 0">
		// 商品分类第二个下拉菜单
		 get_category('{$level_cat2[2]}','extend_cat_id_3','{$level_cat2[3]}');	 
	</if>

});
</script>		
</body>
</html>